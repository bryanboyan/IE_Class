<h1>Charge</h1>

<!-- below datetimepicker -->
<link rel="stylesheet" type="text/css" href="/styles/jquery.datetimepicker.css">
<script src="/js/jquery.datetimepicker.js"></script>

<form role="form" id="chargeForm" action="/charge/creaupdate" method="post">
	<% if (charge.id) { %>
		<input name="id" type="hidden" value="<%= charge.id %>">
	<% } %>
	<div class="form-group">
		<label for="userId">student ID</label><br>
		<input id="userId" class="userInfo" name="userId" type="text" value="<%= charge.userId || '' %>" required>
	</div>
	<div class="form-group">
		<label for="userName">student Name</label><br>
		<input id="userName" class="userInfo" name="userName" type="text" value="<%= charge.userName || '' %>" required>
	</div>
	<div class="form-group">
		<label for="amount">Amount</label><br>
		<input id="amount" name="amount" type="number" value="<%= charge.amount || '' %>" required>
	</div>
	<div class="form-group">
		<label for="timeAt">timeAt (Option, default NOW)</label><br>
		<input id="timeAt" name="timeAt" value="<%= charge.timeAt || '' %>">
	</div>
	<button type="submit" class="btn btn-primary">Submit</button>
</form>

<script type="text/javascript">
$(".userInfo").change(function(){
	var key = this.id;
	var value = $(this).val();
	var paramStr = "key="+key+"&value="+value;
	$.get('/user/retrieveInfo?'+paramStr, function(data) {
		var user = data.user;

		if (user) {
			$("#userId").val(user.id);
			$("#userName").val(user.name);
		} else {
			console.log('error happened: ',JSON.stringify(data));
		}

	}).fail(function(err) {
		//TODO	ALERT user not found error
		console.log('FAIL happened: ',JSON.stringify(arguments));
	});
});

// change format of timeAt datetime
var timeAt = $("#timeAt").val();
if (timeAt !='' ) {
	var time_formated = Date.format(timeAt, 'Y/m/d H:i');
	$("#timeAt").val(time_formated);
}

// datetime picker
$(function() {
  $( "#timeAt" ).datetimepicker({
  	format:'Y/m/d H:i',
  	step:30
  });
});
</script>